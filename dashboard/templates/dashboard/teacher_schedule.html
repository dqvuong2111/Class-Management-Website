{% extends 'dashboard/teacher_base_dashboard.html' %}
{% load static %}

{% block title %}Teacher Schedule{% endblock %}

{% block content %}
<div class="flex flex-col h-[calc(100vh-8rem)] space-y-2"> <!-- Fixed height container -->
    
    <!-- Header -->
    <div class="flex items-center justify-between shrink-0">
        <h1 class="text-xl font-bold text-gray-900">My Schedule</h1>
        
        <!-- Compact Month Navigation -->
        <div class="flex items-center space-x-2 bg-white p-1 rounded-lg shadow-sm border border-gray-200">
            <a href="?month={{ prev_month }}&year={{ prev_year }}" class="p-1 hover:bg-gray-100 rounded-lg text-gray-600 transition-colors">
                <i data-lucide="chevron-left" class="h-4 w-4"></i>
            </a>
            <h2 class="text-sm font-semibold text-gray-800 min-w-[120px] text-center">
                {{ current_month_name }} {{ current_year }}
            </h2>
            <a href="?month={{ next_month }}&year={{ next_year }}" class="p-1 hover:bg-gray-100 rounded-lg text-gray-600 transition-colors">
                <i data-lucide="chevron-right" class="h-4 w-4"></i>
            </a>
        </div>
    </div>
    
    <!-- Calendar Grid (Fills remaining space) -->
    <div class="bg-white shadow rounded-lg overflow-hidden border border-gray-200 flex flex-col grow min-h-0">
        <!-- Days Header -->
        <div class="grid grid-cols-7 border-b border-gray-200 bg-gray-50 shrink-0">
            <div class="py-1 text-center text-[10px] font-semibold text-gray-500 uppercase tracking-wider">Mon</div>
            <div class="py-1 text-center text-[10px] font-semibold text-gray-500 uppercase tracking-wider">Tue</div>
            <div class="py-1 text-center text-[10px] font-semibold text-gray-500 uppercase tracking-wider">Wed</div>
            <div class="py-1 text-center text-[10px] font-semibold text-gray-500 uppercase tracking-wider">Thu</div>
            <div class="py-1 text-center text-[10px] font-semibold text-gray-500 uppercase tracking-wider">Fri</div>
            <div class="py-1 text-center text-[10px] font-semibold text-gray-500 uppercase tracking-wider">Sat</div>
            <div class="py-1 text-center text-[10px] font-semibold text-gray-500 uppercase tracking-wider">Sun</div>
        </div>

        <!-- Weeks (Auto-distribute height) -->
        <div class="divide-y divide-gray-200 flex flex-col grow overflow-hidden">
            {% for week in calendar_data %}
            <div class="grid grid-cols-7 divide-x divide-gray-200 grow basis-0 min-h-0 overflow-hidden">
                {% for day in week %}
                    <div class="relative p-1 {% if day.day == 0 %}bg-gray-50{% elif day.is_today %}bg-indigo-50{% else %}bg-white{% endif %} hover:bg-gray-50 transition-colors h-full flex flex-col min-h-0">
                        {% if day.day != 0 %}
                            <div class="flex justify-between items-start shrink-0 mb-1">
                                <span class="text-[10px] font-medium {% if day.is_today %}text-indigo-600 bg-indigo-100 w-5 h-5 flex items-center justify-center rounded-full{% else %}text-gray-700{% endif %}">
                                    {{ day.day }}
                                </span>
                            </div>
                            
                            <!-- Events container with scroll -->
                            <div class="overflow-y-auto custom-scrollbar flex-1 min-h-0 space-y-1">
                                {% for event in day.events %}
                                <div class="bg-indigo-100 border-l-2 border-indigo-500 rounded p-1 text-[10px] group cursor-pointer hover:bg-indigo-200 transition-colors leading-tight" title="{{ event.class_name }} - {{ event.room }}">
                                    <div class="font-semibold text-indigo-900 truncate">{{ event.time }}</div>
                                    <div class="text-indigo-800 line-clamp-2">{{ event.class_name }}</div>
                                </div>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>
                {% endfor %}
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<style>
/* Custom scrollbar for calendar cells */
.custom-scrollbar::-webkit-scrollbar {
    width: 6px;
}
.custom-scrollbar::-webkit-scrollbar-track {
    background: #f1f5f9;
}
.custom-scrollbar::-webkit-scrollbar-thumb {
    background-color: #94a3b8;
    border-radius: 20px;
}
.custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background-color: #64748b;
}
</style>
{% endblock %}
